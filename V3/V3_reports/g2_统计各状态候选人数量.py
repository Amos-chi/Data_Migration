# Time : 2022/10/31 13:46
import requests
proxies = {
   'http': 'http://127.0.0.1:4780',
   'https': 'http://127.0.0.1:4780'
}

url = 'https://api-staging.hitalentech.com:8888/report/api/v3/report/pipeline/details'
header = {'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsicmVzX2FwaSJdLCJ1c2VyX25hbWUiOiJ7XCJhY3RpdmF0ZWRcIjp0cnVlLFwiZW1haWxcIjpcImxpbGlhbi5saXVAaW50ZWxsaXByb2dyb3VwLmNvbVwiLFwiZmlyc3ROYW1lXCI6XCJMaWxpYW5cIixcImlkXCI6NDcxLFwibGFzdE5hbWVcIjpcIkxpdVwiLFwicGhvbmVcIjpcIlwiLFwidGVuYW50SWRcIjo0LFwidWlkXCI6XCI0NzEsNFwiLFwidXNlcm5hbWVcIjpcImxpbGlhbi5saXVAaW50ZWxsaXByb2dyb3VwLmNvbVwifSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE2NjcyMDA3MTksImF1dGhvcml0aWVzIjpbIlJPTEVfVEVOQU5UX0FETUlOIiwiUk9MRV9VU0VSIl0sImp0aSI6IjJlOTI3MTYwLThiZTQtNGQyOS05NzQ4LWJiZjk2ZTU1YTBkMiIsImNsaWVudF9pZCI6ImFwaWFwcCJ9.ZH4reaxT7v3u7rhylBzZ2Cv2RZ278uW3WA-Ao_X0-vY'}

def get_各个状态数量():
    payload = {"activityId":"118142,118270,118271,118272,118274,118275,118276,118278,118279,118280,118281,118282,118283,118284,118286,118286,118288,118289,118290,118291,118293,118294,118295,118296,118297,118298,118299,118300,118300,118301,118302,118303,118304,118305,118306,118307,118308,118309,118311,118312,118313,118314,118315,118316,118317,118318,118321,118321,118322,118323,118324,118325,118326,118328,118328,118329,118331,118332,118334,118335,118336,118337,118338,118339,118340,118341,118342,118343,118344,118345,118346,118347,118348,118349,118350,118351,118353,118354,118356,118357,118358,118359,118361,118362,118363,118364,118365,118366,118367,118368,118369,118370,118371,118372,118373,118374,118375,118376,118377,118378,118379,118380,118381,118382,118383,118384,118385,118386,118388,118389,118390,118391,118392,118394,118395,118396,118399,118400,118401,118402,118403,118404,118405,118406,118407,118408,118409,118410,118411,118413,118414,118415,118417,118419,118421,118422,118423,118424,118425,118426,118427,118428,118429,118430,118431,118432,118433,118434,118435,118436,118437,118438,118439,118440,118441,118442,118443,118444,118445,118446,118447,118448,118450,118451,118452,118454,118456,118457,118458,118459,118460,118461,118462,118463,118464,118465,118466,118467,118468,118470,118471,118473,118474,118475,118476,118477,118478,118479,118480,118483,118484,118485,118486,118487,118488,118489,118490,118494,118495,118496,118498,118501,118502,118504,118505,118508,118509,118511,118512,118513,118515,118516,118517,118518,118519,118520,118524,118526,118527,118528,118529,118530,118531,118533,118535,118536,118537,118538,118539,118540,118541,118542,118543,118544,118545,118546,118547,118548","size":10000,"timeZone":"Asia/Shanghai","status":"SUBMIT_TO_CLIENT"}

    resp = requests.post(url, json=payload, headers=header, proxies=proxies)
    print(f'resp.status_code : {resp.status_code}')

    print(f'len(resp.json()) : {len(resp.json())}  \n')

    list_SUBMIT_TO_JOB = []
    for j in resp.json():
        if j['currentStatus'] == 'SUBMIT_TO_JOB':
            list_SUBMIT_TO_JOB.append(j['talentName'])
    print(f'SUBMIT_TO_JOB : {len(list_SUBMIT_TO_JOB)}')

    list_SUBMIT_TO_CLIENT = []
    for j in resp.json():
        if j['currentStatus'] == 'SUBMIT_TO_CLIENT':
            list_SUBMIT_TO_CLIENT.append(j['talentName'])
    print(f'SUBMIT_TO_CLIENT : {len(list_SUBMIT_TO_CLIENT)}')

    list_INTERVIEW = []
    for j in resp.json():
        if j['currentStatus'] == 'INTERVIEW':
            list_INTERVIEW.append(j['talentName'])
    print(f'INTERVIEW : {len(list_INTERVIEW)}')

    list_OFFER = []
    for j in resp.json():
        if j['currentStatus'] == 'OFFER':
            list_OFFER.append(j['talentName'])
    print(f'OFFER : {len(list_OFFER)}')

    list_OFFER_ACCEPT = []
    for j in resp.json():
        if j['currentStatus'] == 'OFFER_ACCEPT':
            list_OFFER_ACCEPT.append(j['talentName'])
    print(f'OFFER_ACCEPT : {len(list_OFFER_ACCEPT)}')

    list_START = []
    for j in resp.json():
        if j['currentStatus'] == 'START':
            list_START.append(j['talentName'])
    print(f'START : {len(list_START)}')

    list_ELIMINATED = []
    for j in resp.json():
        if j['currentStatus'] == 'ELIMINATED':
            list_ELIMINATED.append(j['talentName'])
    print(f'ELIMINATED : {len(list_ELIMINATED)}')

    print(f'result: {len(list_SUBMIT_TO_CLIENT)+len(list_INTERVIEW)+len(list_OFFER)+len(list_OFFER_ACCEPT)+len(list_START)+len(list_ELIMINATED)+len(list_SUBMIT_TO_JOB)}')

    others = []
    for j in resp.json():
        if j['currentStatus'] not in ['SUBMIT_TO_JOB', 'SUBMIT_TO_CLIENT', 'INTERVIEW', 'OFFER', 'OFFER_ACCEPT', 'START', 'ELIMINATED']:
            others.append(j['talentName'])
    print(f'others : {len(others)}')
    f = open('others_aaa.txt', 'w', encoding= 'utf-8')
    f.write(','.join(others))

def 交集():
    payload = {"activityId":"118142,118270,118271,118272,118274,118275,118276,118278,118279,118280,118281,118282,118283,118284,118286,118286,118288,118289,118290,118291,118293,118294,118295,118296,118297,118298,118299,118300,118300,118301,118302,118303,118304,118305,118306,118307,118308,118309,118311,118312,118313,118314,118315,118316,118317,118318,118321,118321,118322,118323,118324,118325,118326,118328,118328,118329,118331,118332,118334,118335,118336,118337,118338,118339,118340,118341,118342,118343,118344,118345,118346,118347,118348,118349,118350,118351,118353,118354,118356,118357,118358,118359,118361,118362,118363,118364,118365,118366,118367,118368,118369,118370,118371,118372,118373,118374,118375,118376,118377,118378,118379,118380,118381,118382,118383,118384,118385,118386,118388,118389,118390,118391,118392,118394,118395,118396,118399,118400,118401,118402,118403,118404,118405,118406,118407,118408,118409,118410,118411,118413,118414,118415,118417,118419,118421,118422,118423,118424,118425,118426,118427,118428,118429,118430,118431,118432,118433,118434,118435,118436,118437,118438,118439,118440,118441,118442,118443,118444,118445,118446,118447,118448,118450,118451,118452,118454,118456,118457,118458,118459,118460,118461,118462,118463,118464,118465,118466,118467,118468,118470,118471,118473,118474,118475,118476,118477,118478,118479,118480,118483,118484,118485,118486,118487,118488,118489,118490,118494,118495,118496,118498,118501,118502,118504,118505,118508,118509,118511,118512,118513,118515,118516,118517,118518,118519,118520,118524,118526,118527,118528,118529,118530,118531,118533,118535,118536,118537,118538,118539,118540,118541,118542,118543,118544,118545,118546,118547,118548","size":10000,"timeZone":"Asia/Shanghai","status":"SUBMIT_TO_CLIENT"}

    resp = requests.post(url, json=payload, headers=header, proxies=proxies)
    print(f'resp.status_code : {resp.status_code}')

    txt = "De'Ja Easter,Jake W.,Magaline Harvey (She / Her),王晓波,田倩倩,黄文校,姜学柱,Scott Chen,Aleksandr Omelyanov,艾伦,Jeanie Zheng,Chuang Wen Liu,Javier Fernandez,Nigisti Habtay,Keith Mckay,James Hart,Rachel Rutti,Andrew Y. Huang,Kenan Rustamov,Nick Munos,Zheng Shang,Nate Welter"
    list = txt.split(',')
    print(len(list))

    for j in resp.json():
        if j['talentName'] in list:
            print(j['talentName'])



if __name__ == '__main__':
    get_各个状态数量()
    #交集()
